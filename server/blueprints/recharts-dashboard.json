{
  "name": "Recharts Analytics Dashboard",
  "description": "Dashboard with pie charts, bar charts, and summary cards using Recharts",
  "category": "component",
  "files": [
    {
      "path": "src/components/Dashboard.tsx",
      "content": "\nimport React, { useState, useEffect, useCallback, createContext, useContext, ReactNode } from 'react';\nimport { User, ViewType, Category, Expense, AnalyticsSummary } from './types';\nimport { api } from './services/api';\nimport { BarChart, Bar, XAxis, YAxis, Tooltip, ResponsiveContainer, PieChart, Pie, Cell, Legend } from 'recharts';\nimport { TrendingUp, LayoutDashboard, Wallet, Shapes, Settings, LogOut, Loader2, PlusCircle, MoreVertical, Trash2, Edit, X } from 'lucide-react';\n\n// --- Authentication Context ---\ninterface AuthContextType {\n  user: User | null;\n  token: string | null;\n  isAuthenticated: boolean;\n  isLoading: boolean;\n  login: (email: string, password: string) => Promise<void>;\n  register: (username: string, email: string, password: string) => Promise<void>;\n  logout: () => void;\n}\n\nconst AuthContext = createContext<AuthContextType | null>(null);\n\nexport const useAuth = () => {\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n};\n\n// FIX: Made children prop optional to resolve \"Property 'children' is missing\" error.\nconst AuthProvider = ({ children }: { children?: ReactNode }) => {\n  const [user, setUser] = useState<User | null>(null);\n  const [token, setToken] = useState<string | null>(localStorage.getItem('authToken'));\n  const [isLoading, setIsLoading] = useState(true);\n\n  const fetchUser = useCallback(async () => {\n    if (token) {\n      try {\n        const userData = await api.get<User>('/auth/me');\n        setUser(userData);\n      } catch (error) {\n        console.error('Failed to fetch user', error);\n        setToken(null);\n        localStorage.removeItem('authToken');\n      }\n    }\n    setIsLoading(false);\n  }, [token]);\n\n  useEffect(() => {\n    fetchUser();\n  }, [fetchUser]);\n\n  const handleAuthResponse = (response: { user: User; access_token: string }) => {\n    setUser(response.user);\n    setToken(response.access_token);\n    localStorage.setItem('authToken', response.access_token);\n  };\n\n  const login = async (email: string, password: string) => {\n    const response = await api.post<{ user: User; access_token: string }>('/auth/login', { email, password });\n    handleAuthResponse(response);\n  };\n\n  const register = async (username: string, email: string, password: string) => {\n    const response = await api.post<{ user: User; access_token: string }>('/auth/register', { username, email, password });\n    handleAuthResponse(response);\n  };\n\n  const logout = () => {\n    setUser(null);\n    setToken(null);\n    localStorage.removeItem('authToken');\n  };\n\n  return (\n    <AuthContext.Provider value={{ user, token, isAuthenticated: !!token, isLoading, login, register, logout }}>\n      {children}\n    </AuthContext.Provider>\n  );\n};\n\n// --- Helper UI Components ---\nconst Input = (props: React.InputHTMLAttributes<HTMLInputElement>) => (\n    <input {...props} className=\"w-full bg-input text-foreground px-3 py-2 rounded-md border border-border focus:outline-none focus:ring-2 focus:ring-ring\" />\n);\n\nconst Button = ({ children, onClick, className = '', variant = 'primary', isLoading = false, ...props }: { children: ReactNode, onClick?: () => void, className?: string, variant?: 'primary' | 'secondary' | 'destructive', isLoading?: boolean } & React.ButtonHTMLAttributes<HTMLButtonElement>) => {\n    const baseClasses = 'inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none px-4 py-2';\n    const variantClasses = {\n        primary: 'bg-primary text-primary-foreground hover:bg-primary/90',\n        secondary: 'bg-secondary text-secondary-foreground hover:bg-secondary/80',\n        destructive: 'bg-destructive text-destructive-foreground hover:bg-destructive/90',\n    };\n    return (\n        <button onClick={onClick} className={`${baseClasses} ${variantClasses[variant]} ${className}`} disabled={isLoading} {...props}>\n            {isLoading ? <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" /> : null}\n            {children}\n        </button>\n    );\n};\n\n// FIX: Made children prop optional to resolve \"Property 'children' is missing\" error.\nconst Card = ({ children, className = '' }: { children?: ReactNode, className?: string }) => (\n    <div className={`bg-card text-card-foreground border border-border rounded-lg shadow-sm ${className}`}>\n        {children}\n    </div>\n);\n\n// FIX: Made children prop optional to resolve \"Property 'children' is missing\" error.\nconst Modal = ({ isOpen, onClose, title, children }: { isOpen: boolean; onClose: () => void; title: string; children?: ReactNode }) => {\n    if (!isOpen) return null;\n    return (\n        <div className=\"fixed inset-0 bg-background/80 backdrop-blur-sm z-50 flex items-center justify-center\">\n            <div className=\"bg-card border border-border rounded-lg shadow-xl w-full max-w-md m-4\">\n                <div className=\"flex items-center justify-between p-4 border-b border-border\">\n                    <h3 className=\"text-lg font-semibold\">{title}</h3>\n                    <button onClick={onClose} className=\"text-muted-foreground hover:text-foreground\">\n                        <X className=\"h-5 w-5\" />\n                    </button>\n                </div>\n                <div className=\"p-4\">{children}</div>\n            </div>\n        </div>\n    );\n};\n\n// --- App Pages/Views ---\n\nconst AuthPage = () => {\n    const [isLogin, setIsLogin] = useState(true);\n    const [email, setEmail] = useState('');\n    const [password, setPassword] = useState('');\n    const [username, setUsername] = useState('');\n    const [error, setError] = useState('');\n    const [isLoading, setIsLoading] = useState(false);\n    const { login, register } = useAuth();\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        setError('');\n        setIsLoading(true);\n        try {\n            if (isLogin) {\n                await login(email, password);\n            } else {\n                await register(username, email, password);\n            }\n        } catch (err: any) {\n            setError(err.message || 'An error occurred.');\n        } finally {\n            setIsLoading(false);\n        }\n    };\n    \n    return (\n        <div className=\"min-h-screen flex items-center justify-center bg-background\">\n            <Card className=\"w-full max-w-sm p-8\">\n                <div className=\"flex items-center justify-center mb-6\">\n                    <TrendingUp className=\"h-8 w-8 text-primary\" />\n                    <h1 className=\"text-3xl font-bold ml-2\">ExpenseFlow</h1>\n                </div>\n                <div className=\"flex justify-center mb-6\">\n                    <button onClick={() => setIsLogin(true)} className={`px-4 py-2 text-sm font-medium ${isLogin ? 'text-primary border-b-2 border-primary' : 'text-muted-foreground'}`}>Login</button>\n                    <button onClick={() => setIsLogin(false)} className={`px-4 py-2 text-sm font-medium ${!isLogin ? 'text-primary border-b-2 border-primary' : 'text-muted-foreground'}`}>Register</button>\n                </div>\n                <form onSubmit={handleSubmit} className=\"space-y-4\">\n                    {!isLogin && (\n                        <Input type=\"text\" placeholder=\"Username\" value={username} onChange={(e) => setUsername(e.target.value)} required />\n                    )}\n                    <Input type=\"email\" placeholder=\"Email\" value={email} onChange={(e) => setEmail(e.target.value)} required />\n                    <Input type=\"password\" placeholder=\"Password\" value={password} onChange={(e) => setPassword(e.target.value)} required />\n                    {error && <p className=\"text-red-500 text-sm\">{error}</p>}\n                    <Button type=\"submit\" className=\"w-full\" isLoading={isLoading}>{isLogin ? 'Login' : 'Create Account'}</Button>\n                </form>\n            </Card>\n        </div>\n    );\n};\n\nconst Dashboard = () => {\n    const [summary, setSummary] = useState<AnalyticsSummary | null>(null);\n    const [isLoading, setIsLoading] = useState(true);\n    \n    useEffect(() => {\n        const fetchSummary = async () => {\n            try {\n                const data = await api.get<AnalyticsSummary>('/analytics/summary');\n                setSummary(data);\n            } catch (error) {\n                console.error(\"Failed to fetch summary:\", error);\n            } finally {\n                setIsLoading(false);\n            }\n        };\n        fetchSummary();\n    }, []);\n\n    if (isLoading) return <div className=\"flex justify-center items-center h-full\"><Loader2 className=\"h-8 w-8 animate-spin\" /></div>;\n    if (!summary) return <div>No data available.</div>;\n\n    const COLORS = ['#0088FE', '#00C49F', '#FFBB28', '#FF8042', '#8884d8', '#82ca9d'];\n\n    return (\n        <div className=\"p-6 space-y-6\">\n            <h2 className=\"text-3xl font-bold\">Dashboard</h2>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n                <Card className=\"p-4\">\n                    <h3 className=\"text-muted-foreground text-sm\">Total Expenses</h3>\n                    <p className=\"text-2xl font-bold\">{summary.total_expenses}</p>\n                </Card>\n                <Card className=\"p-4\">\n                    <h3 className=\"text-muted-foreground text-sm\">Total Amount</h3>\n                    <p className=\"text-2xl font-bold\">${summary.total_amount.toFixed(2)}</p>\n                </Card>\n                 <Card className=\"p-4\">\n                    <h3 className=\"text-muted-foreground text-sm\">Avg Expense Amount</h3>\n                    <p className=\"text-2xl font-bold\">${(summary.total_amount / (summary.total_expenses || 1)).toFixed(2)}</p>\n                </Card>\n            </div>\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n                <Card className=\"p-4\">\n                    <h3 className=\"font-semibold mb-4\">Expenses by Category</h3>\n                    <ResponsiveContainer width=\"100%\" height={300}>\n                        <PieChart>\n                            <Pie data={summary.by_category} dataKey=\"total\" nameKey=\"category_name\" cx=\"50%\" cy=\"50%\" outerRadius={80} fill=\"#8884d8\" label>\n                                {summary.by_category.map((entry, index) => (\n                                    <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />\n                                ))}\n                            </Pie>\n                            <Tooltip formatter={(value: number) => `$${value.toFixed(2)}`} />\n                            <Legend />\n                        </PieChart>\n                    </ResponsiveContainer>\n                </Card>\n                <Card className=\"p-4\">\n                    <h3 className=\"font-semibold mb-4\">Monthly Expenses</h3>\n                    <ResponsiveContainer width=\"100%\" height={300}>\n                        <BarChart data={summary.by_month}>\n                            <XAxis dataKey=\"month\" stroke=\"hsl(215 20.2% 65.1%)\" />\n                            <YAxis stroke=\"hsl(215 20.2% 65.1%)\" />\n                            <Tooltip cursor={{ fill: 'hsl(217.2 32.6% 17.5%)' }} contentStyle={{ backgroundColor: 'hsl(222.2 84% 4.9%)', border: '1px solid hsl(217.2 32.6% 17.5%)' }} />\n                            <Bar dataKey=\"total\" fill=\"hsl(217.2 91.2% 59.8%)\" />\n                        </BarChart>\n                    </ResponsiveContainer>\n                </Card>\n            </div>\n        </div>\n    );\n};\n\nconst Expenses = () => {\n    const [expenses, setExpenses] = useState<Expense[]>([]);\n    const [categories, setCategories] = useState<Category[]>([]);\n    const [isLoading, setIsLoading] = useState(true);\n    const [isModalOpen, setIsModalOpen] = useState(false);\n    const [editingExpense, setEditingExpense] = useState<Expense | null>(null);\n\n    const fetchExpensesAndCategories = useCallback(async () => {\n        setIsLoading(true);\n        try {\n            const [expenseRes, categoryRes] = await Promise.all([\n                api.get<{ expenses: Expense[] }>('/expenses'),\n                api.get<{ categories: Category[] }>('/categories')\n            ]);\n            setExpenses(expenseRes.expenses);\n            setCategories(categoryRes.categories);\n        } catch (error) {\n            console.error(\"Failed to fetch data:\", error);\n        } finally {\n            setIsLoading(false);\n        }\n    }, []);\n\n    useEffect(() => {\n        fetchExpensesAndCategories();\n    }, [fetchExpensesAndCategories]);\n\n    const handleSaveExpense = async (expenseData: Partial<Expense>) => {\n        try {\n            if (editingExpense) {\n                await api.put(`/expenses/${editingExpense.id}`, expenseData);\n            } else {\n                await api.post('/expenses', expenseData);\n            }\n            setIsModalOpen(false);\n            setEditingExpense(null);\n            fetchExpensesAndCategories();\n        } catch (error) {\n            console.error(\"Failed to save expense:\", error);\n        }\n    };\n    \n    const handleDeleteExpense = async (id: string) => {\n        if(window.confirm(\"Are you sure you want to delete this expense?\")) {\n            try {\n                await api.delete(`/expenses/${id}`);\n                fetchExpensesAndCategories();\n            } catch (error) {\n                console.error(\"Failed to delete expense:\", error);\n            }\n        }\n    };\n    \n    // FIX: Add explicit type annotation to fix type inference issue where category was `unknown`.\n    const categoryMap: Map<string, Category> = new Map(categories.map(c => [c.id, c]));\n\n    return (\n        <div className=\"p-6\">\n            <div className=\"flex justify-between items-center mb-6\">\n                <h2 className=\"text-3xl font-bold\">Expenses</h2>\n                <Button onClick={() => { setEditingExpense(null); setIsModalOpen(true); }} className=\"flex items-center gap-2\">\n                    <PlusCircle className=\"h-5 w-5\" />\n                    Add Expense\n                </Button>\n            </div>\n            {isLoading ? (\n                <div className=\"flex justify-center items-center h-full\"><Loader2 className=\"h-8 w-8 animate-spin\" /></div>\n            ) : (\n                <Card>\n                    <div className=\"overflow-x-auto\">\n                        <table className=\"w-full text-left\">\n                            <thead className=\"border-b border-border\">\n                                <tr>\n                                    <th className=\"p-4\">Date</th>\n                                    <th className=\"p-4\">Description</th>\n                                    <th className=\"p-4\">Category</th>\n                                    <th className=\"p-4 text-right\">Amount</th>\n                                    <th className=\"p-4\"></th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                {expenses.map(expense => {\n                                    const category = categoryMap.get(expense.category_id);\n                                    return (\n                                    <tr key={expense.id} className=\"border-b border-border last:border-b-0\">\n                                        <td className=\"p-4\">{new Date(expense.date).toLocaleDateString()}</td>\n                                        <td className=\"p-4\">{expense.description}</td>\n                                        <td className=\"p-4\">\n                                            {category ? (\n                                                <span className=\"flex items-center gap-2\">\n                                                    <span style={{color: category.color}}>{category.icon}</span>\n                                                    {category.name}\n                                                </span>\n                                            ) : 'N/A'}\n                                        </td>\n                                        <td className=\"p-4 text-right font-mono\">${expense.amount.toFixed(2)}</td>\n                                        <td className=\"p-4 text-right\">\n                                           <Button variant=\"secondary\" size=\"sm\" onClick={() => { setEditingExpense(expense); setIsModalOpen(true); }} className=\"mr-2\"><Edit className=\"h-4 w-4\" /></Button>\n                                           <Button variant=\"destructive\" size=\"sm\" onClick={() => handleDeleteExpense(expense.id)}><Trash2 className=\"h-4 w-4\" /></Button>\n                                        </td>\n                                    </tr>\n                                )})}\n                            </tbody>\n                        </table>\n                    </div>\n                </Card>\n            )}\n            <ExpenseForm \n                isOpen={isModalOpen}\n                onClose={() => { setIsModalOpen(false); setEditingExpense(null); }}\n                onSave={handleSaveExpense}\n                expense={editingExpense}\n                categories={categories}\n            />\n        </div>\n    );\n};\n\n\ninterface ExpenseFormProps {\n    isOpen: boolean;\n    onClose: () => void;\n    onSave: (expense: Partial<Expense>) => void;\n    expense: Expense | null;\n    categories: Category[];\n}\n\nconst ExpenseForm = ({ isOpen, onClose, onSave, expense, categories }: ExpenseFormProps) => {\n    const [amount, setAmount] = useState('');\n    const [description, setDescription] = useState('');\n    const [categoryId, setCategoryId] = useState('');\n    const [date, setDate] = useState('');\n\n    useEffect(() => {\n        if (expense) {\n            setAmount(expense.amount.toString());\n            setDescription(expense.description);\n            setCategoryId(expense.category_id);\n            setDate(expense.date.split('T')[0]);\n        } else {\n            setAmount('');\n            setDescription('');\n            setCategoryId('');\n            setDate(new Date().toISOString().split('T')[0]);\n        }\n    }, [expense, isOpen]);\n    \n    const handleSubmit = (e: React.FormEvent) => {\n        e.preventDefault();\n        onSave({ amount: parseFloat(amount), description, category_id: categoryId, date });\n    };\n\n    return (\n        <Modal isOpen={isOpen} onClose={onClose} title={expense ? 'Edit Expense' : 'Add Expense'}>\n            <form onSubmit={handleSubmit} className=\"space-y-4\">\n                <Input type=\"number\" placeholder=\"Amount\" value={amount} onChange={(e) => setAmount(e.target.value)} required step=\"0.01\"/>\n                <Input type=\"text\" placeholder=\"Description\" value={description} onChange={(e) => setDescription(e.target.value)} required />\n                <select value={categoryId} onChange={(e) => setCategoryId(e.target.value)} required className=\"w-full bg-input text-foreground px-3 py-2 rounded-md border border-border focus:outline-none focus:ring-2 focus:ring-ring\">\n                    <option value=\"\" disabled>Select a category</option>\n                    {categories.map(c => <option key={c.id} value={c.id}>{c.icon} {c.name}</option>)}\n                </select>\n                <Input type=\"date\" value={date} onChange={(e) => setDate(e.target.value)} required />\n                <div className=\"flex justify-end gap-2\">\n                    <Button type=\"button\" variant=\"secondary\" onClick={onClose}>Cancel</Button>\n                    <Button type=\"submit\">Save</Button>\n                </div>\n            </form>\n        </Modal>\n    );\n};\n\nconst Categories = () => {\n    // Placeholder for Categories view\n    return (\n      <div className=\"p-6\">\n        <h2 className=\"text-3xl font-bold\">Categories</h2>\n        <Card className=\"mt-6 p-6 text-center\">\n            <p className=\"text-muted-foreground\">Category management is coming soon.</p>\n        </Card>\n      </div>\n    );\n};\n\nconst Budgets = () => {\n    // Placeholder for Budgets view\n    return (\n        <div className=\"p-6\">\n          <h2 className=\"text-3xl font-bold\">Budgets</h2>\n          <Card className=\"mt-6 p-6 text-center\">\n              <p className=\"text-muted-foreground\">Budget tracking is coming soon.</p>\n          </Card>\n        </div>\n      );\n};\n\n// --- Main Layout ---\nconst SIDEBAR_ITEMS = [\n    { name: 'Dashboard', icon: LayoutDashboard, view: 'dashboard' as ViewType },\n    { name: 'Expenses', icon: Wallet, view: 'expenses' as ViewType },\n    { name: 'Categories', icon: Shapes, view: 'categories' as ViewType },\n    { name: 'Budgets', icon: TrendingUp, view: 'budgets' as ViewType },\n];\n\nconst Sidebar = ({ activeView, setActiveView }: { activeView: ViewType, setActiveView: (view: ViewType) => void }) => (\n    <aside className=\"w-64 bg-card border-r border-border flex flex-col\">\n        <div className=\"p-4 border-b border-border flex items-center\">\n            <TrendingUp className=\"h-8 w-8 text-primary\" />\n            <h1 className=\"text-xl font-bold ml-2\">ExpenseFlow</h1>\n        </div>\n        <nav className=\"flex-1 p-4 space-y-2\">\n            {SIDEBAR_ITEMS.map(item => (\n                <button\n                    key={item.name}\n                    onClick={() => setActiveView(item.view)}\n                    className={`w-full flex items-center px-3 py-2 rounded-md text-sm font-medium transition-colors ${activeView === item.view ? 'bg-secondary text-foreground' : 'text-muted-foreground hover:bg-secondary/50 hover:text-foreground'}`}\n                >\n                    <item.icon className=\"h-5 w-5 mr-3\" />\n                    {item.name}\n                </button>\n            ))}\n        </nav>\n    </aside>\n);\n\nconst Header = () => {\n    const { user, logout } = useAuth();\n    return (\n        <header className=\"h-16 bg-card border-b border-border flex items-center justify-end px-6\">\n            <div className=\"flex items-center gap-4\">\n                <span className=\"text-sm\">Welcome, {user?.username}</span>\n                <Button variant=\"secondary\" onClick={logout}>\n                    <LogOut className=\"h-4 w-4 mr-2\" />\n                    Logout\n                </Button>\n            </div>\n        </header>\n    );\n}\n\nconst MainLayout = () => {\n    const [activeView, setActiveView] = useState<ViewType>('dashboard');\n    \n    const renderView = () => {\n        switch (activeView) {\n            case 'dashboard': return <Dashboard />;\n            case 'expenses': return <Expenses />;\n            case 'categories': return <Categories />;\n            case 'budgets': return <Budgets />;\n            default: return <Dashboard />;\n        }\n    };\n\n    return (\n        <div className=\"flex h-screen bg-background text-foreground\">\n            <Sidebar activeView={activeView} setActiveView={setActiveView} />\n            <div className=\"flex-1 flex flex-col overflow-hidden\">\n                <Header />\n                <main className=\"flex-1 overflow-y-auto\">\n                    {renderView()}\n                </main>\n            </div>\n        </div>\n    );\n};\n\n\nexport default function App() {\n    return (\n        <AuthProvider>\n            <AppContent />\n        </AuthProvider>\n    );\n}\n\nfunction AppContent() {\n    const { isAuthenticated, isLoading } = useAuth();\n    if (isLoading) {\n        return <div className=\"min-h-screen flex items-center justify-center\"><Loader2 className=\"h-10 w-10 animate-spin text-primary\" /></div>;\n    }\n    return isAuthenticated ? <MainLayout /> : <AuthPage />;\n}\n",
      "role": "COMPONENT",
      "language": "typescript",
      "size": 23476,
      "order": 0
    }
  ]
}